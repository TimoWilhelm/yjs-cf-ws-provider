<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta http-equiv="X-UA-Compatible" content="ie=edge" />
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css" />
		<title>Collaborative Editor Demo App</title>
		<style>
			html,
			body {
				height: 100%;
				margin: 0;
			}
			.container {
				height: 100%;
				display: flex;
				flex-direction: column;
				align-items: stretch;
				gap: 1rem;
			}
			#editor {
				display: flex;
				flex: 1;
				border: 2px solid gray;
				border-radius: 10px;
			}
			#editor:focus-within {
				border-color: #2684ff;
			}
			.ProseMirror {
				width: 100%;
				flex-grow: 1;
				padding: 1rem;
			}
			.ProseMirror:focus {
				outline: none;
			}
			/* TipTap caret */
			.collaboration-carets__caret {
				border-left: 1px solid #0d0d0d;
				border-right: 1px solid #0d0d0d;
				margin-left: -1px;
				margin-right: -1px;
				pointer-events: none;
				position: relative;
				word-break: normal;
			}

			/* Render the username above the caret */
			.collaboration-carets__label {
				border-radius: 3px 3px 3px 0;
				color: white;
				font-size: 12px;
				font-style: normal;
				font-weight: 600;
				left: -1px;
				line-height: normal;
				padding: 0.1rem 0.3rem;
				position: absolute;
				top: -1.4em;
				user-select: none;
				white-space: nowrap;
			}

			.participants {
				display: block;
				resize: none;
				height: 10vh;
				overflow: auto;
				flex: 1;
			}
		</style>
	</head>
	<body>
		<div class="container">
			<span style="text-align: center; font-weight: bold; padding-top: 0.5rem">
				Demo App for <a href="https://github.com/TimoWilhelm/yjs-cf-ws-provider">Durable Object Yjs WebSocket Provider</a>
			</span>
			<div style="display: flex; justify-content: center; padding-top: 0.5rem">
				<span id="connection-status" style="text-transform: capitalize; font-weight: bold">Status: Disconnected</span>
			</div>

			<div style="display: flex; justify-content: center; gap: 1rem">
				<button id="connection-toggle">Connect</button>
				<button id="copy-link">Copy Room Link</button>
			</div>

			<div style="display: flex; justify-content: center; gap: 1rem">
				<details>
					<summary>Show QR Code</summary>
					<canvas id="qr-canvas"></canvas>
				</details>
			</div>

			<div id="editor"></div>

			<div style="display: flex; gap: 1rem">
				<div>Connected Clients:</div>
				<div class="participants"></div>
			</div>
		</div>

		<script type="module" src="/src/frontend.ts"></script>
	</body>
</html>
